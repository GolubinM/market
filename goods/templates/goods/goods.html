{% extends 'seller/base.html' %}
{% load static %}
{% block content %}

<h2 class="cat_title">Товары<br></h2>

<h5>Фильтр товаров по категории</h5>
<form action="{%url  'goods' %}" method="post">
    {% csrf_token %}
    <div class="inline">
        {% for fcat in form_category %}
        {{ fcat }}
        {% endfor %}
        <button class="btn" type="submit">Установить</button>
    </div>
    <div class="form-error">{{f.errors}}</div>
</form>
<h5>Фильтр товаров по цене</h5>

<h4 class="info_string">Товаров: {{ goods.count }}
    {% if request.user.is_staff %}
    <a class="add_model" href="{% url 'create-good'%}"> + Добавить товар</a>
    {% endif %}
    {% if request.user.is_authenticated and not request.user.is_staff %}
    <a class="cart_link" href="{% url 'cart_view' %}"> в корзине: {{ cart_quantity }} </a>
    {% endif %}
    {% if not request.user.is_authenticated %}
    <em class="last">Необходимо зарегистрироваться и авторизоваться для совершения покупки</em>
    {% endif %}
</h4>

<div class="models">
    {% for good in goods %}
    <div class="elements">
        {% if request.user.is_staff %}
        <h3 class="top"><a href="{% url 'viewgood' good.pk %}">{{ good.title }}</a></h3>

        <h2 class="current_price">{{ good.current_price }}</h2>

        <div class="decription-text"><p>{{ good.description | striptags | truncatechars:18 }}</p></div>
        <a href="{% url 'viewgood' good.pk %}"><img class="model_img" src="{{ good.picture.url }}" alt="img"></a>
        {% else %}
        <h3 class="top"><a href="">{{ good.title }}</a></h3>

        <h2 class="current_price">{{ good.current_price }}</h2>

        <div class="decription-text"><p>{{ good.description | striptags | truncatechars:18 }}</p></div>
        <a href=""><img class="model_img" src="{{ good.picture.url }}" alt="img"></a>
        {% if request.user.is_authenticated %}
        <p class="add_to_cart_text">в корзину <a class="add_to_cart_lnk" href="{% url 'add_to_cart' good.pk %}">+</a>
        </p>
        {% endif %}

        {% endif %}
    </div>
    {% endfor %}
</div>
{% endblock %}
